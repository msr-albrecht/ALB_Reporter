services:
  app:
    build: .
    container_name: alb_reporter_container
    ports:
      - "4055:4055"
    volumes:
      - ./arbeiter.csv:/app/arbeiter.csv
      - ./.env:/app/.env
      - db-data:/app/db
      - ssl-data:/app/ssl
    environment:
      - NODE_ENV=production
      - DOCKER_ENV=true
      - DB_PATH=/app/db/reports.db
      - PORT=4055
      - FILE_SERVER_URL=http://file-server:3003
      - SERVER_URL=https://localhost:4055
    depends_on:
      - file-server
    networks:
      - berichte-network
    restart: unless-stopped

  file-server:
    build: ./file-server
    ports:
      - "3003:3003"
    networks:
      - berichte-network

volumes:
  db-data:
  ssl-data:

networks:
  berichte-network:
    driver: bridge
